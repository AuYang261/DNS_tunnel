cmake_minimum_required(VERSION 3.15)

project(DNS_TUNNEL LANGUAGES "CXX")
set(CMAKE_CXX_STANDARD 17)

aux_source_directory(src DIR_SRCS)
file (GLOB SOURCES CONFIGURE_DEPENDS "src/*.cpp" "include/*.h")
add_executable(dns_tunnel_detection ${SOURCES})
target_include_directories(dns_tunnel_detection PRIVATE ${PROJECT_SOURCE_DIR}/include)


if (CMAKE_HOST_APPLE)
	target_link_directories(dns_tunnel_detection PUBLIC "/usr/local/opt/pcapplusplus/lib")
	target_include_directories(dns_tunnel_detection PRIVATE "/usr/local/opt/pcapplusplus/include/pcapplusplus")
	target_include_directories(dns_tunnel_detection PRIVATE "${MACOS_SDK_HOME}/usr/include/netinet")
	target_link_libraries(dns_tunnel_detection PUBLIC "Common++" "Packet++" "Pcap++" "pcap" "pthread")
	target_compile_options(dns_tunnel_detection PUBLIC -DPCAPP_CPP_FEATURE_DETECTION)
endif ()
